webpackJsonp([1],{"88QE":function(e,t){},"HY/O":function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("+RKF"),a=i("bQIR"),l=i.n(a),n=(i("gFLX"),i("gUGA")),o=i.n(n),s=i("3cXf"),c=i.n(s),m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("blockquote",{staticClass:"elem-quote",class:this.type},[this._t("default",[t("div",{domProps:{innerHTML:this._s(this.explain)}})])],2)},staticRenderFns:[]};var p=i("C7Lr")({data:function(){return{}},props:["explain","type"]},m,!1,function(e){i("rx9I")},null,null).exports,u={components:{quote:p}},f={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"divider-container"},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("絮絮叨叨")])],1),e._v(" "),i("quote",{attrs:{type:"info"}},[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【序言】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("本来吧，我是想弄图床的，后来想想，啊，都用Gitee了，反正啥文件都能存了，干嘛不整一个文件床啊，免得以后要存一些小东小西还要到处丢，一步到位它不香么\n        "),i("a",{attrs:{href:"javascript:;"}})])])]),e._v(" "),i("quote",[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【关于Gitee】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("单仓库大小上限为500M，单文件最大100M，用户总仓库容量为5G，虽然我没有做任何上传限制，但是也不要瞎搞")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("单仓库容量不够的问题，我已经通过切换仓库的方法，来获得总共5G的容量，大概率是够了")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("万一真有文件按G算的重度使用者，请出门右拐，腾讯，阿里，七牛欢迎您")])])]),e._v(" "),i("quote",{attrs:{type:"danger"}},[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【关于Github】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("这个倒是不限制大小，好像能有100G？不过架不住人家慢啊，而且我上传上去的图片，不知道咋的，外链拿到打不开")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        好像说是域名\n        "),i("span",{staticClass:"badge"},[e._v("raw.githubusercontent.com")]),e._v("被DNS污染了\n      ")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("这样的话，造成了我同一个图片链接，在同一个WIFI下，PC打不开，手机QQ打得开，手机微信又打不开的奇怪事件")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("不能指望每个看文件的人都会消除污染，太不现实了，所以果断抛弃这个选项")])])]),e._v(" "),i("quote",[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【关于文件床】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("我记得博客园自定义主页，有时候是需要外链JS和CSS文件的，有时候还需要外链一些鼠标的样式文件，音乐文件，所以有类似需求的人可用，用不上这些的话，当图床用也是很不错的")])])]),e._v(" "),i("quote",{attrs:{type:"danger"}},[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【关于图床】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        目前我用过，做的比较好的，大概是\n        "),i("b",[e._v("PicGo")]),e._v(" ，不习惯我这个可以考虑用它，但其实和utools提供的图床功能差不多\n      ")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("因为考虑到以后啊，大概会有很多地方都用上，扔其他地方，哪天要换图片，就见鬼了")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("我把写日记的图片，写博客的图片，写文档的图片，都丢在一个地方，几百张里面找一张，啧，异常酸爽")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        我这个插件，更主要的功能就是\n        "),i("b",[e._v("区分文件夹")]),e._v("，适合有整理强迫症的同好们\n      ")])])]),e._v(" "),i("quote",[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【关于utools-filebed】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("起源于，emmm，好吧，就是闲的蛋疼，其他图床我用着不爽，就酱")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("我没有写批量删除的功能，主要是想让你们上传文件的时候更克制一些，当然，还有一部分原因是因为我懒")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("用着有问题或者有想加的功能，就去Gitee上提，或者去utools的社区里面提，我反正是肯定不会改的，hhh")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("更新嘛，大概还是会更新的，不过估计更新一次得等上个把月，大家可以考虑先将就用着")])])]),e._v(" "),i("quote",{attrs:{type:"danger"}},[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【更新方向】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("首先就是上传文件那一块，可能会提出来，放在主板上，上传文件就不用再点一下按钮了，现在我自己都略微有一点点嫌弃")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("然后就是短链接了，现在复制出来的链接太长了，想复制出来短一点，可能就需要第三方的服务，第三方如果炸了，那就呵呵了，所以还在考虑，慎重考虑")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("还有那个图标视图，虽然加起来好像挺快，毕竟功能都写好了，but，我懒啊，先鸽着")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("还有一个是左侧边栏，在有三四层文件夹的情况下，我最初的设想是可以通过左侧边栏，一步抵达，就不用在面板上一层一层点下去了，挺麻烦的，说实话。也先鸽着吧，反正现在能用，这些都不急")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("还有一个，就是代码实在太丑了，第一次用vue，什么组件啊，生命周期啊，命令啊，天知道我是怎么写下来的，我连npm和webpack都是第一次用，得抽空重构代码，那大概就是2.0版本了吧，任重而道远")])])])],1)},staticRenderFns:[]};var d=i("C7Lr")(u,f,!1,function(e){i("PfHm")},null,null).exports,_={components:{quote:p}},v={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"divider-container"},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("配置文档")])],1),e._v(" "),i("quote",[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【注册Gitee】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        地址：\n        "),i("a",{attrs:{href:"https://gitee.com/login",target:"_blank"}},[e._v("https://gitee.com/login")])])])]),e._v(" "),i("quote",[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【创建仓库】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        地址：\n        "),i("a",{attrs:{href:"https://gitee.com/projects/new",target:"_blank"}},[e._v("https://gitee.com/projects/new")])]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        在创建仓库时，\n        "),i("b",[e._v('仓库名称和路径请保持一致，需要选择"是否开源"，请选择"公开"')]),e._v("，其他配置不需要改动\n      ")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("而一旦选择公开后，所有人都能看到你的仓库里面的东西，所以不要往仓库里面上传乱七八糟的文件")])])]),e._v(" "),i("quote",[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【私人令牌】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        地址：\n        "),i("a",{attrs:{href:"https://gitee.com/profile/personal_access_tokens",target:"_blank"}},[e._v("https://gitee.com/profile/personal_access_tokens")])]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v('点击"生成新令牌"，令牌描述推荐"utools-filebed"，权限请勾选"projects"')]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[i("b",[e._v("务必保管好生成的令牌，也就是我们俗称的token")])]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("至此，Gitee网站上的配置就结束了")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[i("img",{attrs:{src:"https://gitee.com/stepdust/FileBed/raw/master/MarkDown/utools-filebed/create_token.png",alt:"create_token.png",width:"100%"}})]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[i("img",{attrs:{src:"https://gitee.com/stepdust/FileBed/raw/master/MarkDown/utools-filebed/create_token_str.png",alt:"create_token_str.png",width:"100%"}})])])]),e._v(" "),i("quote",{attrs:{type:"danger"}},[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【owner】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v('这是你在注册Gitee账号时填写的"个人空间地址"，比如说我的就是"StepDust"，不区分大小写')]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v('填好后，需要点击后面的"纸飞机"图标，会根据owner自动获取所有的公开仓库')]),e._v(" "),i("li",[i("img",{attrs:{src:"https://gitee.com/stepdust/FileBed/raw/master/MarkDown/utools-filebed/owner.png",alt:"owner.png",width:"100%"}})])])]),e._v(" "),i("quote",{attrs:{type:"danger"}},[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【repo】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("如果你创建了公开仓库，在点击owner后的小飞机后，会出现这个选项")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("请选择你用于存储文件的仓库，可以多选，毕竟一个仓库的容量只有500M，略小")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[i("img",{attrs:{src:"https://gitee.com/stepdust/FileBed/raw/master/MarkDown/utools-filebed/repo.png",alt:"repo.png",width:"100%"}})])])]),e._v(" "),i("quote",{attrs:{type:"danger"}},[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("【token】")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("请填写你在Gitee网站中获取到的私人令牌(token)")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("utools-filebed不会收集token，也没有使用utools提供的数据库接口，token只保存于本地")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("更换电脑后，utools-filebed缓存的所有数据和配置都会丢失")])])])],1)},staticRenderFns:[]},h=i("C7Lr")(_,v,!1,null,null,null).exports,g=i("I29D"),b=i.n(g).a.create({baseURL:"https://gitee.com/api",headers:{"Content-Type":"application/json;charset=utf-8"}});b.interceptors.request.use(function(e){return e},function(e){return e}),b.interceptors.response.use(function(e){return e},function(e){return e}),b.ajax=function(e){if("get"===e.modth){for(var t in e.url+="?",e.params)e.url+=t+"="+e.params[t]+"&";e.url=e.url.substr(0,e.url.length-1)}return b({method:e.modth,url:e.url,data:e.params})};var w=b,C=function(e){return JSON.parse(c()(e))},y=function(e,t){for(var i in e=e.replace(" ",""),t)e=e.replace("{{"+i+"}}",t[i]);return e},x={explain:"获取某个用户的公开仓库",source:"https://gitee.com/api/v5/swagger#/getV5UsersUsernameRepos",url:"/v5/users/{{owner}}/repos",modth:"get",params:{type:"personal",sort:"full_name",page:1,per_page:100}},k={explain:"获取目录Tree",source:"https://gitee.com/api/v5/swagger#/getV5ReposOwnerRepoGitTreesSha",url:"/v5/repos/{{owner}}/{{repo}}/git/trees/{{sha}}",modth:"get",params:{recursive:0}},S={explain:"获取文件Blob",source:"https://gitee.com/api/v5/swagger#/getV5ReposOwnerRepoGitBlobsSha",url:"/v5/repos/{{owner}}/{{repo}}/git/blobs/{{sha}}",modth:"get",params:{}},R={explain:"新建文件",source:"https://gitee.com/api/v5/swagger#/postV5ReposOwnerRepoContentsPath",url:"/v5/repos/{{owner}}/{{repo}}/contents/{{path}}",modth:"post",params:{access_token:"",content:"",message:"utools-filebed，新建文件",committer:{name:"utools-plugin-filebed",email:"z.onlooker@qq.com"}}},F={explain:"删除文件",source:"https://gitee.com/api/v5/swagger#/deleteV5ReposOwnerRepoContentsPath",url:"/v5/repos/{{owner}}/{{repo}}/contents/{{path}}",modth:"delete",params:{access_token:"",sha:"",message:"utools-filebed，删除文件",committer:{name:"utools-plugin-filebed",email:"z.onlooker@qq.com"}}},T={config:{owner:"",repo:"",sha:"",token:""},getBaseUrl:function(){return w.defaults.baseURL},getV5UsersUsernameRepos:function(){var e=C(x);return e.url=y(e.url,this.config),w.ajax(e)},getV5ReposOwnerRepoGitTreesSha:function(e,t){var i=C(k);return i.url=y(i.url,this.config),i.url=i.url.replace("{{sha}}",e),i.params.recursive=t||0,w.ajax(i)},getV5ReposOwnerRepoGitBlobsSha:function(e){var t=C(S);return t.url=y(t.url,this.config),t.url=t.url.replace("{{sha}}",e),w.ajax(t)},postV5ReposOwnerRepoContentsPath:function(e,t){var i=C(R);return i.url=y(i.url,this.config),i.url=i.url.replace("{{path}}",e),i.params.message+=":"+e,i.params.content=t,i.params.access_token=this.config.token,w.ajax(i)},deleteV5ReposOwnerRepoContentsPath:function(e,t){var i=C(F);return i.url=y(i.url,this.config),i.url=i.url.replace("{{path}}",e),i.params.sha=t,i.params.message+=":"+e,i.params.access_token=this.config.token,w.ajax(i)}},D={dirname:null,cache:null,init:function(){if(window.customCache){if(this.cache=window.customCache,this.dirname=this.cache.getDirname(),!this.dirname)return;var e=this.dirname.lastIndexOf("\\plugins");e>-1?this.dirname=this.dirname.substr(0,e+1)+"Cache\\filebed_cache\\":this.dirname.lastIndexOf(".")>-1?this.dirname=this.dirname.substr(0,this.dirname.lastIndexOf("\\")+1)+"filebed_cache\\":this.dirname+="\\filebed_cache\\",this.cache.mkdirSync(this.dirname)}},setData:function(e,t){this.dirname?this.cache.writeFileSync(this.dirname+e+".data",t):localStorage.setItem(e,t)},getData:function(e,t){t=t||!1;var i="";i=this.dirname?this.cache.readFileSync(this.dirname+e+".data"):localStorage.getItem(e);try{t&&(i=JSON.parse(i))}catch(e){i=null}return i},clearData:function(){this.dirname?this.cache.clear(this.dirname):localStorage.clear()}};D.init();var L={components:{quote:p,xxdd:d,pzwd:h},data:function(){return{form:{url:"www.gitee.com",owner:"",token:"",repo:[],repoByAll:[]},xxdd:!1,pzwd:!1,dirname:D.dirname}},methods:{getUsersRepos:function(){var e=this;T.config.owner=this.form.owner,this.form.repoByAll=[],this.form.repo=[],T.getV5UsersUsernameRepos().then(function(t){t.data.forEach(function(t){e.form.repoByAll.push({id:t.id,full_name:t.full_name,path:t.path,name:t.name,description:t.description})})})},onSubmit:function(){D.setData("giteeSetting",c()(this.form)),this.$emit("init")},onClear:function(){D.clearData(),this.form={url:"www.gitee.com",owner:"",token:"",repo:[],repoByAll:[]}}},created:function(){this.form=D.getData("giteeSetting",!0)||this.form}},O={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("div",{staticClass:"divider-container"},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("Gitee配置")])],1),e._v(" "),i("quote",[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("\n        本插件是文件床，基于\n        "),i("b",[e._v("Gitee")]),e._v("，请自行注册和配置Gitee\n      ")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        不推荐上传\n        "),i("b",[e._v("大文件(10M+)和隐私文件")])]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        【\n        "),i("a",{staticClass:"xd",attrs:{href:"javascript:;"},on:{click:function(t){e.xxdd=!0}}},[e._v("絮絮叨叨")]),e._v("】 ，\n        【\n        "),i("a",{staticClass:"xd",attrs:{href:"javascript:;"},on:{click:function(t){e.pzwd=!0}}},[e._v("配置文档")]),e._v("】\n      ")]),e._v(" "),i("li",{directives:[{name:"show",rawName:"v-show",value:e.dirname,expression:"dirname"}],staticClass:"el-form-item__label"},[e._v("\n        缓存地址："),i("br"),e._v(" "),i("b",[e._v(e._s(e.dirname))])])])]),e._v(" "),i("el-form-item",{staticStyle:{"margin-top":"16px"},attrs:{label:"url"}},[i("el-input",{attrs:{readonly:"",placeholder:"Gitee主页"},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"owner",gutter:20},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}},[i("el-col",{attrs:{span:19}},[i("el-input",{attrs:{value:"stepdust",placeholder:"个人空间地址，例：Dust"},model:{value:e.form.owner,callback:function(t){e.$set(e.form,"owner",t)},expression:"form.owner"}})],1),e._v(" "),i("el-col",{attrs:{span:3,offset:1}},[i("el-button",{attrs:{icon:"el-icon-s-promotion",circle:""},on:{click:e.getUsersRepos}})],1)],1),e._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.repoByAll&&0!=e.form.repoByAll.length,expression:"form.repoByAll&&form.repoByAll.length!=0"}],attrs:{label:"repo"}},[i("el-select",{attrs:{multiple:"",placeholder:"仓库路径"},model:{value:e.form.repo,callback:function(t){e.$set(e.form,"repo",t)},expression:"form.repo"}},e._l(e.form.repoByAll,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"token"}},[i("el-input",{attrs:{placeholder:"用户授权码"},model:{value:e.form.token,callback:function(t){e.$set(e.form,"token",t)},expression:"form.token"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("更新配置")]),e._v(" "),i("el-button",{on:{click:e.onClear}},[e._v("清除")])],1),e._v(" "),i("el-drawer",{attrs:{size:"500px","append-to-body":!0,visible:e.xxdd,"with-header":!1},on:{"update:visible":function(t){e.xxdd=t}}},[i("xxdd")],1),e._v(" "),i("el-drawer",{attrs:{size:"500px","append-to-body":!0,visible:e.pzwd,"with-header":!1},on:{"update:visible":function(t){e.pzwd=t}}},[i("pzwd")],1)],1)},staticRenderFns:[]};var z=i("C7Lr")(L,O,!1,function(e){i("HY/O")},"data-v-5ca20e90",null).exports,A=i("PlJU"),M=i.n(A),q=i("CnW6"),G=i.n(q),U=i("Adsf"),B=i.n(U),$=G()(B.a);D.init();var N={components:{quote:p,api:T,filePond:$,Clipboard:M.a,dataManager:D},data:function(){return{timestamp:!1,fileUrl:""}},props:["repo","folder"],methods:{changeTimestamp:function(e){this.timestamp=e,D.setData(this.repo.id+"_timestamp",this.timestamp)},removeFile:function(){},copyLink:function(){var e=!1,t=document.createElement("input");t.setAttribute("value",this.fileUrl),t.setAttribute("readonly","readonly"),document.body.appendChild(t),t.select(),t.setSelectionRange(0,9999),document.execCommand("copy")&&(document.execCommand("copy"),e=!0),document.body.removeChild(t),e?this.sendMsg("链接复制成功"):this.sendMsg("链接复制失败，请于主页面中复制")},sendMsg:function(e,t){setTimeout(function(){console.log("1："+Notification.permission),window.Notification&&"denied"!==Notification.permission&&Notification.requestPermission(function(i){(console.log("2: "+i),"granted"===i)?new Notification("utools-filebed消息",{body:e,icon:"./src/assets/logo.png"}).onclick=t:alert("当前浏览器不支持弹出消息")})},1e3)},getDate:function(){var e=function(e,t){for(e+="";e.length<t;)e="0"+e;return e},t=new Date,i=t.getFullYear(),r=t.getMonth()+1,a=t.getDate(),l=t.getHours(),n=t.getMinutes(),o=t.getSeconds(),s=t.getMilliseconds();return""+e(i,4)+e(r,2)+e(a,2)+"-"+e(l,2)+e(o,2)+e(n,2)+"-"+e(s,4)}},mounted:function(){var e=this;this.timestamp="true"===D.getData(this.repo.id+"_timestamp"),Object(q.setOptions)({server:{process:function(t,i,r,a,l,n,o,s,m){var p=i.name;if(!0===e.timestamp||"image.png"===p){var u="",f=p.lastIndexOf(".");f>-1&&(u=p.substr(f+1).toLowerCase()),p=e.getDate()+"."+u}var d=new FileReader,_=new XMLHttpRequest,v=e.copyLink,h=e.sendMsg;return d.readAsDataURL(i),d.onload=function(){var t={access_token:T.config.token,content:d.result,message:"utools-filebed，新建文件:"+p};if(0!==d.result.length){t.content=t.content.split(",")[1];var i=(e.folder?e.folder.path:"")+"/"+p;e.fileUrl="https://gitee.com/"+T.config.owner+"/"+T.config.repo+"/raw/master/"+i,_.open("POST",T.getBaseUrl()+"/v5/repos/"+T.config.owner+"/"+T.config.repo+"/contents/"+i),_.setRequestHeader("content-type","application/json"),_.upload.onprogress=function(e){n(e.lengthComputable,e.loaded,e.total)},_.onload=function(){_.status>=200&&_.status<300?(a(_.responseText),h("上传成功，点击复制链接",v)):h("上传失败")},_.send(c()(t))}},{abort:function(){_.abort(),o()}}}}})}},P={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"divider-container"},[i("el-divider",{attrs:{"content-position":"left"}},[e._v("上传文件")])],1),e._v(" "),i("quote",[i("ul",[i("li",{staticClass:"el-form-item__label"},[e._v("\n        单仓库上限为\n        "),i("b",[e._v("500M")]),e._v("，单文件最大\n        "),i("b",[e._v("100M")]),e._v("，总仓库容量为\n        "),i("b",[e._v("5G")])]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("以上是Gitee官方说明，以下是个人建议")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        不推荐上传\n        "),i("b",[e._v("大文件(10M+)和隐私文件")])]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        在MD中使用的\n        "),i("b",[e._v("单张图片，不宜超过1M")]),e._v("，大部分网站无法显示\n      ")]),e._v(" "),i("li",{staticClass:"el-form-item__label"},[e._v("\n        超过\n        "),i("b",[e._v("1M")]),e._v("的图片，本插件无法预览，但链接有效\n      ")])])]),e._v(" "),i("el-col",{attrs:{span:12}},[i("span",{staticClass:"el-form-item__label"},[e._v("\n      时间戳重命名：\n      "),i("el-switch",{on:{change:e.changeTimestamp},model:{value:e.timestamp,callback:function(t){e.timestamp=t},expression:"timestamp"}}),e._v(" "),i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{disabled:"",id:"copy"},domProps:{value:e.fileUrl}})],1)]),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-row",{attrs:{type:"flex",justify:"end"}},[i("el-tooltip",{attrs:{placement:"top",trigger:"hover",content:"鸽着，等我API看明白了再加上"}},[i("span",{staticClass:"el-form-item__label",staticStyle:{padding:"0"}},[i("el-button",{attrs:{size:"mini",disabled:"",icon:"el-icon-delete",type:"danger"},on:{click:e.removeFile}},[e._v("清空列表")])],1)])],1)],1),e._v(" "),i("el-col",{attrs:{span:24}},[i("file-pond",{ref:"pond",attrs:{name:"sdsdsd","class-name":"my-pond","label-idle":"选择文件 or 粘贴截图",labelFileProcessingComplete:"上传成功",labelFileProcessing:"上传中",labelFileProcessingError:"上传失败",labelTapToRetry:"点击重新上传",labelTapToCancel:"点击取消上传",labelTapToUndo:"点击关闭","allow-multiple":"true",styleButtonProcessItemPosition:"right",styleProgressIndicatorPosition:"center"}})],1)],1)},staticRenderFns:[]};var j=i("C7Lr")(N,P,!1,function(e){i("O4mK")},null,null).exports;D.init();var I={components:{quote:p,api:T,uploade:j,Clipboard:M.a,dataManager:D},data:function(){return{tableData:[],panelConfig:{folderSha:"master",viewType:0},drawer:!1,fileTree:[],repo:{},isRefresh:!1,srcList:[]}},computed:{nav:function(){for(var e=this,t=[],i=JSON.parse(c()(this.fileTree)),r=3,a=i.filter(function(t){return t.sha===e.panelConfig.folderSha})[0],l=function(){if(void 0===a)return"break";if(0===r)return t.splice(0,0,{sha:"/",name:"..."}),"break";var e={sha:a.sha},l=a.path.lastIndexOf("/");-1===l?(e.name=a.path,l=0):e.name=a.path.substr(l+1),a=i.filter(function(t){return t.path===a.path.substr(0,l)&&t.sha!==e.sha})[0],r--,t.splice(0,0,e)};;){if("break"===l())break}return t.splice(0,0,{sha:"master",name:"全部文件"}),t}},methods:{refresh:function(e){2===e.button?this.init(this.repo):0===e.button&&this.init(this.repo)},init:function(e){if(this.isRefresh=!0,this.repo=e,this.tableData=[],this.drawer=!1,void 0!==this.repo){try{this.panelConfig=D.getData(this.repo.id+"_panelConfig",!0)||this.panelConfig,T.config.repo=this.repo.name}catch(e){alert(e)}this.getNewFolderSha(!0)}},redirectTree:function(e){var t=this;this.isRefresh=!0,T.getV5ReposOwnerRepoGitTreesSha(e,0).then(function(e){void 0!==e&&(t.panelConfig.folderSha=e.data.sha,D.setData(t.repo.id+"_panelConfig",c()(t.panelConfig)),t.tableData=e.data.tree,t.srcList=[],t.tableData.forEach(function(e){var i=-1;i=e.path.indexOf("/"),e.name=-1===i?e.path:e.path.substr(i+1),i=e.name.lastIndexOf("."),"tree"===e.type||-1===i?e.suffix="folder":e.suffix=e.name.substr(i+1).toLowerCase();e.media="file",["jpg","jpge","gif","jfif","bmp","png","ico","icon"].indexOf(e.suffix)>-1?(e.media="image",t.srcList.push(t.getFileUrl(e))):"folder"===e.suffix&&(e.media="folder"),t.isRefresh=!1}),t.tableData=t.tableData.sort(function(e,t){return e.type===t.type?e.name>t.name:"tree"===e.type&&"blob"===t.type?-1:"blob"===e.type&&"tree"===t.type?1:void 0}))})},getNewFolderSha:function(e){var t=this;T.getV5ReposOwnerRepoGitTreesSha("master",1).then(function(i){var r=JSON.parse(c()(t.fileTree)).filter(function(e){return e.sha===t.panelConfig.folderSha})[0];t.fileTree=i.data.tree;var a=t.panelConfig.folderSha;0===t.fileTree.filter(function(e){return e.sha===a}).length&&(void 0===r?a=i.data.sha:"path"in r&&(r=t.fileTree.filter(function(e){return e.path===r.path})[0],a=void 0===r?i.data.sha:r.sha)),e&&t.redirectTree(a)}).catch(function(){t.$message({message:"网络请求错误，请检查仓库是否有'master'分支",type:"error"}),t.isRefresh=!1})},deleteFile:function(e){var t=this.fileTree.filter(function(t){return t.sha===e.sha})[0];return void 0===t||null===t?(this.$message({message:"不存在文件:"+t.path+"，请刷新后重试",type:"error"}),null):T.deleteV5ReposOwnerRepoContentsPath(t.path,t.sha)},getFileUrl:function(e){var t=this.fileTree.filter(function(t){return t.sha===e.sha&&t.path.indexOf(e.name)>-1})[0];return void 0===t||null===t?(this.$message({message:"不存在文件:"+t.path+"，请刷新后重试",type:"error"}),null):"https://gitee.com/"+T.config.owner+"/"+this.repo.name+"/raw/master/"+t.path},download:function(e,t){var i=this.getFileUrl(e),r=document.createElement("a");r.style.display="none",r.setAttribute("href",i),r.setAttribute("download",t),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i)},createFolder:function(){var e=this,t=this,i=T,r=this.fileTree.filter(function(t){return t.sha===e.panelConfig.folderSha})[0],a=r&&"path"in r?r.path:"";this.$prompt("请输入文件夹地址,支持多层级，用'/'区分<br/>由于Gitee不支持空文件夾，会自动生成.keep文件","提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,inputValue:a+"/"}).then(function(e){var r=e.value;i.postV5ReposOwnerRepoContentsPath(r+"/.keep","6aG555uu5ZCN56ew77yadXRvb2xzLWZpbGViZWQK5LuT5bqT5Zyw5Z2A77yaaHR0cHM6Ly9naXRlZS5jb20vU3RlcER1c3QvdXRvb2xzLWZpbGViZWQ=").then(function(e){e.isAxiosError?t.$message({type:"error",message:"文件夹创建失败"}):t.$message({type:"success",message:"文件夹创建成功 "}),t.init(t.repo)})})},getRowClick:function(e,t){if(t=t||!1,"folder"!==e.media){if("image"===e.media&&t)document.getElementById("err_"+e.sha)?this.$message({type:"warning",message:"文件太大，预览失败，请复制链接至浏览器打开"}):document.getElementById(e.sha).click();else this.$message({type:"warning",message:window.location.host+",不是图片文件，无法打开预览"});return!1}this.redirectTree(e.sha)},deleteSingleFile:function(e){var t=this,i=this;this.$confirm("此操作将永久删除该文件, 找回请自行去Gitee操作","提示",{lockScroll:!1,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.deleteFile(e).then(function(e){e.isAxiosError?i.$message({type:"error",message:"删除失败："+e.response.data.message}):(i.$message({type:"success",message:"删除成功!"}),i.init(i.repo))})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},downloadSingleFile:function(e){this.download(e,e.name)},copyLink:function(e,t){var i=this,r=new M.a(".el-button");r.on("success",function(e){i.$message({message:"复制成功",type:"succes"}),r.destroy()}),r.on("error",function(e){i.$message({message:"复制失败",type:"error"}),r.destroy()})}},filters:{iconFilter:function(e){return"folder"===e.media?"el-icon-folder":"image"===e.media?"el-icon-picture-outline":"el-icon-document"},sizeFilter:function(e){if("folder"===e.media)return"-";var t=e.size/1024,i="KB";return t>100&&(t/=1024,i="MB"),t>100&&(t/=1024,i="GB"),Math.round(100*t)/100+"  "+i},linkFilter:function(e,t,i){var r=i(e),a=r;return"html"===(t=(""+t).toLowerCase())?a='<img src="'+r+'" alt="'+e.name+'" width="100%" />':"md"===t&&(a="!["+e.name+"]("+r+")"),a}}},E={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{staticClass:"panel"},[i("el-header",{attrs:{height:"auto"}},[i("quote",{attrs:{explain:void 0===e.repo?"暂无数据":e.repo.description||e.repo.name}})],1),e._v(" "),i("el-header",{staticStyle:{margin:"16px 0"},attrs:{height:"auto"}},[i("el-row",[i("el-col",{attrs:{span:18}},[i("el-button",{attrs:{size:"medium",icon:"el-icon-upload2",type:"primary"},on:{click:function(t){e.drawer=!0}}},[e._v("上传")]),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{size:"medium",icon:"el-icon-download",type:"info"}},[e._v("下载")]),e._v(" "),i("el-button",{attrs:{size:"medium",icon:"el-icon-folder-add"},on:{click:e.createFolder}},[e._v("新建文件夹")]),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{size:"medium",icon:"el-icon-delete",type:"danger"}},[e._v("删除")])],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-row",{attrs:{type:"flex",justify:"end"}},[i("el-radio-group",{attrs:{size:"medium"},model:{value:e.panelConfig.viewType,callback:function(t){e.$set(e.panelConfig,"viewType",t)},expression:"panelConfig.viewType"}},[i("el-radio-button",{attrs:{label:"0"}},[e._v("列表")]),e._v(" "),i("el-tooltip",{attrs:{placement:"bottom",trigger:"hover",content:"鸽着，暂时还不想写"}},[i("el-radio-button",{attrs:{label:"1",disabled:""}},[e._v("图标")])],1)],1)],1)],1)],1)],1),e._v(" "),i("el-header",{attrs:{height:"auto"}},[i("el-breadcrumb",{staticStyle:{"margin-top":"16px"},attrs:{"separator-class":"el-icon-arrow-right"}},e._l(e.nav,function(t,r){return i("el-breadcrumb-item",{key:r},[i("span",{on:{click:function(i){"/"!==t.sha&&e.redirectTree(t.sha)}}},[i("el-link",{attrs:{href:"javascript:;",underline:!1,type:"primary"}},[e._v(e._s(t.name))])],1)])}),1)],1),e._v(" "),i("el-main",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isRefresh,expression:"isRefresh"}],staticStyle:{width:"100%"},attrs:{height:"380","highlight-current-row":"",stripe:"",data:e.tableData}},[i("el-table-column",{attrs:{type:"index",width:"50",align:"right"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-link",{attrs:{type:"folder"===t.row.media?"primary":""}},["image"!==t.row.media?i("i",{class:e._f("iconFilter")(t.row),staticStyle:{"font-size":"20px"},on:{click:function(i){return i.stopPropagation(),e.getRowClick(t.row)}}}):e._e(),e._v(" "),"image"===t.row.media?i("el-image",{attrs:{lazy:"","scroll-container":".el-table__body-wrapper",fit:"fill",id:t.row.sha,src:e.getFileUrl(t.row),"preview-src-list":e.srcList}},[i("div",{attrs:{slot:"placeholder"},slot:"placeholder"},[i("i",{staticClass:"el-icon-refresh",staticStyle:{"font-size":"20px",animation:"turn 1s linear infinite"}})]),e._v(" "),i("div",{attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"20px"},attrs:{id:"err_"+t.row.sha}})])]):e._e(),e._v(" "),i("span",{staticStyle:{"margin-left":"5px"},on:{click:function(i){return i.stopPropagation(),e.getRowClick(t.row,!0)}}},[e._v(e._s(t.row.name))])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"size",label:"大小",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("sizeFilter")(t.row)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"链接地址",width:"275",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{directives:[{name:"show",rawName:"v-show",value:"folder"===t.row.media,expression:"scope.row.media==='folder'"}]},[e._v("-")]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"folder"!==t.row.media,expression:"scope.row.media!=='folder'"}]},[i("el-button",{attrs:{type:"default",icon:"el-icon-link","data-clipboard-text":e._f("linkFilter")(t.row,"url",e.getFileUrl),size:"mini",plain:""},on:{click:function(i){return e.copyLink(t.row,"url")}}},[e._v("URL")]),e._v(" "),i("el-button",{attrs:{type:"info",icon:"el-icon-paperclip","data-clipboard-text":e._f("linkFilter")(t.row,"html",e.getFileUrl),size:"mini",plain:""},on:{click:function(i){return e.copyLink(t.row,"html")}}},[e._v("HTML")]),e._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-connection","data-clipboard-text":e._f("linkFilter")(t.row,"md",e.getFileUrl),size:"mini",plain:""},on:{click:function(i){return e.copyLink(t.row,"md")}}},[e._v("MD")])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"name",fixed:"right",width:"100",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{directives:[{name:"show",rawName:"v-show",value:"folder"===t.row.media,expression:"scope.row.media==='folder'"}]},[e._v("-")]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"folder"!==t.row.media,expression:"scope.row.media!=='folder'"}]},[i("el-tooltip",{attrs:{placement:"top",trigger:"hover",content:"删除"}},[i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(i){return e.deleteSingleFile(t.row)}}})],1),e._v(" "),i("el-tooltip",{attrs:{placement:"top",trigger:"hover",content:"下载"}},[i("el-button",{attrs:{icon:"el-icon-download",type:"info",circle:"",size:"mini"},on:{click:function(i){return e.downloadSingleFile(t.row)}}})],1)],1)]}}])})],1)],1),e._v(" "),i("el-tooltip",{attrs:{placement:"left",trigger:"hover",content:"点击刷新列表"}},[i("span",{staticClass:"el-button el-button--primary el-button--medium is-circle float-ball",class:e.isRefresh?"":"stop",on:{mouseup:e.refresh}},[i("i",{staticClass:"el-icon-refresh"})])]),e._v(" "),i("el-drawer",{attrs:{title:"我是标题",size:"500px",visible:e.drawer,"with-header":!1},on:{close:function(t){return e.init(e.repo)},"update:visible":function(t){e.drawer=t}}},[i("uploade",{attrs:{repo:e.repo,folder:e.fileTree.filter(function(t){return t.sha===e.panelConfig.folderSha})[0]}})],1)],1)},staticRenderFns:[]};var V=i("C7Lr")(I,E,!1,function(e){i("88QE")},null,null).exports;D.init();var H={components:{setting:z,panel:V,api:T,dataManager:D},data:function(){return{form:{url:"www.gitee.com",owner:"",token:"",repo:[],repoByAll:[]},repoSel:0,drawer:!1}},computed:{repoArr:function(){var e=this;return this.form.repoByAll.filter(function(t){return e.form.repo.indexOf(t.id)>-1})}},methods:{init:function(){this.drawer=!1,this.form=D.getData("giteeSetting",!0)||this.form,this.repoSel=o()(D.getData("repoSel")),T.config={owner:this.form.owner,token:this.form.token},this.filterRepo(),isNaN(this.repoSel)&&(this.drawer=!0)},filterRepo:function(){var e=this;this.repoArr.length>0&&1!==this.repoArr.filter(function(t){return t.id===e.repoSel}).length&&(this.repoSel=this.repoArr[0].id,T.config.repo=this.repoArr[0].name,D.setData("repoSel",this.repoSel)),this.$refs.panel.init(this.repoArr.filter(function(t){return t.id===e.repoSel})[0])},selectChanged:function(e){var t=this;D.setData("repoSel",this.repoSel);var i=this.repoArr.filter(function(e){return e.id===t.repoSel})[0];this.$refs.panel.init(i)}},mounted:function(){this.init()}},Z={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("el-menu",{staticClass:"el-menu-demo",attrs:{"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b","default-active":"1",mode:"horizontal"}},[i("el-menu-item",{staticClass:"item-right",on:{click:function(t){e.drawer=!0}}},[i("i",{staticClass:"el-icon-s-tools"})]),e._v(" "),i("el-menu-item",{staticClass:"item-right"},[i("el-select",{attrs:{placeholder:"请选择活动仓库"},on:{change:e.selectChanged},model:{value:e.repoSel,callback:function(t){e.repoSel=t},expression:"repoSel"}},e._l(e.repoArr,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("el-menu-item",{staticClass:"item-right is-active",attrs:{index:"1"}},[e._v("文件列表")])],1),e._v(" "),i("el-drawer",{attrs:{size:"500px",visible:e.drawer,"with-header":!1},on:{"update:visible":function(t){e.drawer=t}}},[i("setting",{on:{init:e.init}})],1),e._v(" "),i("panel",{ref:"panel"})],1)},staticRenderFns:[]};var Q=i("C7Lr")(H,Z,!1,function(e){i("ZZIy")},null,null).exports,J=i("Fa/W");r.default.use(J.a);var W=new J.a({routes:[{path:"/",name:"App",component:Q}]});r.default.config.productionTip=!1,r.default.use(l.a),document.oncontextmenu=function(e){e.preventDefault()},new r.default({el:"#app",router:W,components:{App:Q},template:"<App/>"})},O4mK:function(e,t){},PfHm:function(e,t){},ZZIy:function(e,t){},gFLX:function(e,t){},rx9I:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.d20850f77431ea722394.js.map